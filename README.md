# Setting up Debian/Ubuntu Jenkins server
This project help create a jenkins server on a Debian/Ubuntu server.

## Before you begin
1. (Optional) If you want to make the server to be avaliable from the host network, in the `Vagrantfile` you must specify on what interface to expose them.

        config.vm.network "public_network", type: "dhcp", bridge: "interface_name"

## Creating the VM
The VM can will be created by [Vagrant](https://www.vagrantup.com/).

In order to create and lauch the VM, use the following Vagrant command.

    vagrant up

Once done, destroy the vms:

    vagrant destroy

## Lauching ansible against the vagrant machines
Once the machines have been created, they have to be provvisioned.
The tool used by this example to setup the cluster is [Ansible](https://www.redhat.com/en/technologies/management/ansible).

### TIPS:
It's possible to relaunch the playbook `playbook.yml` against the machines made by Vagrant using an inventory autogenerated by Vagrant specifying the inventory path:

    ansible-playbook playbook.yml -i .vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory

To automate this process, it's possible to configure ansible via the `ansible.cfg` file.
To create the file: 

    ansible-config init --disabled > ansible.cfg

Configure the `ansible.cfg` file:

1. Set the inventory to the one generated by vagrant:

        inventory=./.vagrant/provisioners/ansible/inventory/vagrant_ansible_inventory

2. Prevent ansuble from cheching the new VM ssh key:

        host_key_checking=False

3. Specify where the role folder is stored:
        
        roles_path=/path/to/role/

## Jenkins
Jenkins is, by deafult, listening on `port 8080`. 
To reach it visit the address [`http://localhost:8080/`](http://localhost:8080/).

In order to unlock Jenkins the first time is launched, get the password from the file `/var/lib/jenkins/secrets/initialAdminPassword` inside the VM:

    vagrant ssh
    cat /var/lib/jenkins/secrets/initialAdminPassword
